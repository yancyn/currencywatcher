<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>World Currencies History</title>
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script>

  // List out all currencies in the world
  var currencies = [
"AED",
"AFN",
"ALL",
"AMD",
"ANG",
"AOA",
"ARS",
"AUD",
"AWG",
"AZN",
"BAM",
"BBD",
"BDT",
"BGN",
"BHD",
"BIF",
"BMD",
"BND",
"BOB",
"BRL",
"BSD",
"BTC",
"BTN",
"BWP",
"BYR",
"BZD",
"CAD",
"CDF",
"CHF",
"CLF",
"CLP",
"CNY",
"COP",
"CRC",
"CUC",
"CUP",
"CVE",
"CZK",
"DJF",
"DKK",
"DOP",
"DZD",
"EEK",
"EGP",
"ERN",
"ETB",
"EUR",
"FJD",
"FKP",
"GBP",
"GEL",
"GGP",
"GHS",
"GIP",
"GMD",
"GNF",
"GTQ",
"GYD",
"HKD",
"HNL",
"HRK",
"HTG",
"HUF",
"IDR",
"ILS",
"IMP",
"INR",
"IQD",
"IRR",
"ISK",
"JEP",
"JMD",
"JOD",
"JPY",
"KES",
"KGS",
"KHR",
"KMF",
"KPW",
"KRW",
"KWD",
"KYD",
"KZT",
"LAK",
"LBP",
"LKR",
"LRD",
"LSL",
"LTL",
"LVL",
"LYD",
"MAD",
"MDL",
"MGA",
"MKD",
"MMK",
"MNT",
"MOP",
"MRO",
"MTL",
"MUR",
"MVR",
"MWK",
"MXN",
"MYR",
"MZN",
"NAD",
"NGN",
"NIO",
"NOK",
"NPR",
"NZD",
"OMR",
"PAB",
"PEN",
"PGK",
"PHP",
"PKR",
"PLN",
"PYG",
"QAR",
"RON",
"RSD",
"RUB",
"RWF",
"SAR",
"SBD",
"SCR",
"SDG",
"SEK",
"SGD",
"SHP",
"SLL",
"SOS",
"SRD",
"STD",
"SVC",
"SYP",
"SZL",
"THB",
"TJS",
"TMT",
"TND",
"TOP",
"TRY",
"TTD",
"TWD",
"TZS",
"UAH",
"UGX",
"USD",
"UYU",
"UZS",
"VEF",
"VND",
"VUV",
"WST",
"XAF",
"XAG",
"XAU",
"XCD",
"XDR",
"XOF",
"XPD",
"XPF",
"XPT",
"YER",
"ZAR",
"ZMK",
"ZMW",
"ZWL"
  ];

  /**
   * Mask a string value by append zero with a fixed digit.
   * @param value String
   * @param digit Maximum digit to return
   */
  function appendZero(value, digit) {
    var output = "";
    for(i=value.length+1;i<=digit;i++) {
        output += "0";
    }
    output += value.toString();
    return output;
  }

  /**
   * Return string for date in format yyyy-mm-dd.
   */
  function toDateString(date) {
    var output = "";
    var year = date.getFullYear();
    var month = date.getMonth();
    month++;
    var day = date.getDate();

    output += year.toString();
    output += "-";
    output += appendZero(month.toString(),2);
    output += "-";
    output += appendZero(day.toString(),2);
    return output;
  }

  /**
   * Get currency rates from date1 until date2.
   * @param from Unix timestamp in milliseconds
   * @param to Unix timestamp in milliseconds
   * @see https://openexchangerates.org/
   */
  function getRates(from, to) {
    console.log("getRates("+from+","+to+")");
    var app_id = "";
    var date1 = new Date(from);
    var date2 = new Date(to);
    while(from <= to) {
      $.getJSON("https://openexchangerates.org/api/historical/"+toDateString(date1)+".json?app_id="+app_id, function(data) {
        $.each(data.rates, function(key, val) {
          // deduct local time
          var utc = data["timestamp"]*1000 + new Date().getTimezoneOffset()*60*1000;
          var date = new Date(utc);
          console.log(toDateString(date)+"    "+key+":"+val);
        });
      });

      from += 1000*60*60*24;
      date1 = new Date(from);
    }
  }

  $(function() {

    // define dropdownlist for base currency option
    for(i=0;i<currencies.length;i++) {
      $("#base").append("<option value='"+currencies[i]+"'>"+currencies[i]+"</option>");
    }
    // define target currency convert to
    for(i=0;i<currencies.length;i++) {
      $("#to").append("<li><input type='checkbox' name='currency' value='"+currencies[i]+"' />"+currencies[i]+"</li>");
    }

    var date = new Date();
    var year = date.getFullYear();
    var month = date.getMonth();
    var day = date.getDate();
    var from = new Date(year, month, 1);
    var to = new Date(year, month, day);
    //getRates(from.getTime(), to.getTime()); // TODO: Change to correct date period

  });
  </script>
</head>
<body>
  Base<select id="base"></select><input type="submit" value="GET"/><br/>
  To<br/>
  <ul id="to"></ul>
</body>
</html>
